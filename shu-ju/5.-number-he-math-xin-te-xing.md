# 5. number 和 Math 新特性

### 5.1 概述

#### 5.1.1 新的整数语法

现在可以用二进制和八进制制定整数：

```javascript
> 0xFF // ES5: hexadecimal
255
> 0b11 // ES6: binary
3
> 0o10 // ES6: octal
8
```

#### 5.1.2 新的 Number 属性

全局对象 Number 获得了一些新属性：

* Number.EPSILON 用于比较 a tolerance for rounding errors 的浮点数。
*   Number.isInteger(num) 检查 num 是否是整数（没有小数的数字）：\\

    ```
      > Number.isInteger(1.05)
      false
      > Number.isInteger(1)
      true

      > Number.isInteger(-3.1)
      false
      > Number.isInteger(-3)
      true
    ```
* 用于确定一个 JavaScript 整数是否安全的方法和常数（在没有精度损失带符号的 53 位范围内）：
  * `Number.isSafeInteger(number)`
  * `Number.MIN_SAFE_INTEGER`
  * `Number.MAX_SAFE_INTEGER`
*   Number.isNaN(num) 检查 num 是否为 NaN。与全局函数 isNaN() 相比，它不会将其参数强制转换为数字，因此对于非数字来说更安全：

    ```
    > isNaN('???')
    true
    > Number.isNaN('???')
    false
    ```
* Number 的三个附加方法大多等同于具有相同名称的全局函数：Number.isFinite、Number.parseFloat、Number.parseInt。

#### 5.1.3 新的 Math 方法

全局对象 Math 具有用于数值、三角和位运算的新方法。让我们看四个例子。

Math.sign() 返回数字的符号：

```
> Math.sign(-8)
-1
> Math.sign(0)
0
> Math.sign(3)
1
```

Math.trunc() 删除数字的小数部分：

```
> Math.trunc(3.1)
3
> Math.trunc(3.9)
3
> Math.trunc(-3.1)
-3
> Math.trunc(-3.9)
-3
```

Math.log10() 计算以 10 为底的对数：

```
> Math.log10(100)
2
```

Math.hypot() 计算其参数平方和的平方根（毕达哥拉斯定理）：

```
> Math.hypot(3, 4)
5   
```

### 5.2 新的整数

ECMAScript5 已经有了16进制整数：

```
> 0x9
9
> 0xA
10
> 0x10
16
> 0xFF
255
```

ECMAScript6 带来了两种新的整数：

*   二进制开头的 0b 或者 0B：

    ```
     > 0b11
      3
     > 0b100
      4
    ```
*   八进制开头的 0o 或者 0O（这是一个0后面跟了大写的O；第一个变体更安全）：

    ```
    > 0o7
      7
    > 0o10
      8
    ```

请记住，Number 方法 toString(radix) 可用于查看 以 10 以外为基数表示的数字：

```
> 255..toString(16)
'ff'
> 4..toString(2)
'100'
> 8..toString(8)
'10'
```

（双点是必要的，这样访问属性的点和小数点就不会混淆）

#### 5.2.1 八进制用例：Unix风格的文件权限

在 Node.js 文件系统模块中，一些函数有参数 mode。它的值用于指定文件权限，通过一种从 Unix 继承下来的编码：

* 为3类用户指定权限：
  * User：文件所有者
  * Group：与文件关联的组的成员
  * All：所有人
* 每一类中，可以授予以下权限：
  * r(read)：允许类别用户读取文件
  * w(write)：允许类别用户更改文件
  * x(execute)：允许类别用户运行文件

这意味着权限可以用9位表示（3个类别，每个类别有3个权限）：

|             | User  | Group | All   |
| ----------- | ----- | ----- | ----- |
| Permissions | r,w,x | r,w,x | r,w,x |
| Bit         | 8,7,6 | 5,4,3 | 2,1,0 |

每类的用户权限用 3 位存储：

| Bits | Permissions | Octal digit |
| ---- | ----------- | ----------- |
| 000  | ---         | 0           |
| 001  | --x         | 1           |
| 010  | -w-         | 2           |
| 011  | -wx         | 3           |
| 100  | r--         | 4           |
| 101  | r-x         | 5           |
| 110  | rw-         | 6           |
| 111  | rwx         | 7           |

这说明八进制是所有权限的紧凑表示，你只需要 3 位数字，每个用户类别一位数字。两个例子：

* 755 = 111，101，101：所有者可以修改、读和执行；其他人只能读和执行。
* 640 = 110，100，000：所有者可以修改和读；group 用户只能读；其他人无法访问。

#### 5.2.2 Number.parseInt() 和新的整数

Number.parseInt()（与全局函数 parseInt() 的作用相同）有以下 signature：

```javascript
Number.parseInt(string, radix?)
```

\#### 5.2.2.1 Number.parseInt()：十六进制数字\
Number.parseInt() 为十六进制提供了特殊支持 - 字符串前缀 0x（0X）在以下情况会被移除：

* radix 缺失或者为0。然后 radix 设定为 16。通常，不应该省略 radix。
* radix 为 16

例如：

```
> Number.parseInt('0xFF')
255
> Number.parseInt('0xFF', 0)
255
> Number.parseInt('0xFF', 16)
255
```

其他所有情况下，数字只被解析到第一个非数字：

```
> Number.parseInt('0xFF', 10)
0
> Number.parseInt('0xFF', 17)
0
```

\#### 5.2.2.2 Number.parseInt()：二进制和八进制数字

但是，Number.parseInt() 对二进制或者八进制没有特殊支持！

```
> Number.parseInt('0b111')
0
> Number.parseInt('0b111', 2)
0
> Number.parseInt('111', 2)
7

> Number.parseInt('0o10')
0
> Number.parseInt('0o10', 8)
0
> Number.parseInt('10', 8)
8
```

如果你想解析这种类型，需要用 Number()：

```
> Number('0b111')
7
> Number('0o10')
8
```

Number.parseInt() 适用于有不同基数的数字，只要没有特殊前缀并且提供了 radix：

```
> Number.parseInt('111', 2)
7
> Number.parseInt('10', 8)
8
```

### 5.3 新的静态 Number 属性

本节介绍在 ECMAScript6 中，Number 构造函数的新属性。

#### 5.3.1 之前的全局函数

#### 5.3.2 Number.EPSILON

#### 5.3.3 Number.isInteger(number)

#### 5.3.4 安全整数



### 5.4 新的 Math 功能

#### 5.4.1 多种数值功能

#### 5.4.2 用 0 而不是 1 求幂和对数

#### 5.4.3 以 2 和 10 为底的对数

#### 5.4.4 支持编译为 JavaScript

#### 5.4.5 按位运算

#### 5.4.6 三角函数方法

### 5.5 FAQ: numbers

#### 5.5.1 如何使用超出JavaScript 53 位范围的整数？

\
